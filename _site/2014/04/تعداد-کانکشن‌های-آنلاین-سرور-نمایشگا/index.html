<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>تعداد کانکشن‌های آنلاین سرور نمایشگاه کتاب</title>
  <meta name="description" content="برای یافتن کانکشن‌های برقرار شده با یک سرور می‌توانیم از دستور netstat استفاده کنیم و برای شمردن آن‌ها از دستور wc.">
  
  <meta name="keywords" content="amir karimi, geek, programmer, solution architect, solution engineer, tech lead, senior software developer, senior engineer, sre, devops, scala, linux, rust, go, ruby, python" />
  
  
  
  
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/2014/04/%d8%aa%d8%b9%d8%af%d8%a7%d8%af-%da%a9%d8%a7%d9%86%da%a9%d8%b4%d9%86%e2%80%8c%d9%87%d8%a7%db%8c-%d8%a2%d9%86%d9%84%d8%a7%db%8c%d9%86-%d8%b3%d8%b1%d9%88%d8%b1-%d9%86%d9%85%d8%a7%db%8c%d8%b4%da%af%d8%a7/">
  <link rel="alternate" type="application/rss+xml" title="چارچوب توسعه" href="http://localhost:4000/feed.xml" />
</head>


  
  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">چارچوب توسعه</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/%25d8%25aa%25d9%2585%25d8%25a7%25d8%25b3.html">تماس</a>
          
        
          
          <a class="page-link" href="/%25d8%25af%25d8%25b1%25d8%25a8%25d8%25a7%25d8%25b1%25d9%2587-%25d9%2585%25d9%2586.html">درباره</a>
          
        
          
          <a class="page-link" href="/%25d8%25af%25d8%25b1%25d8%25a8%25d8%25a7%25d8%25b1%25d9%2587-%25d9%2585%25d9%2586/%25d8%25b3%25d8%25b1%25da%25af%25d8%25b0%25d8%25b4%25d8%25aa.html">سرگذشت</a>
          
        
          
          <a class="page-link" href="/%25d9%2587%25d9%2585%25da%25a9%25d8%25a7%25d8%25b1%25db%258c.html">همکاری</a>
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">تعداد کانکشن‌های آنلاین سرور نمایشگاه کتاب</h1>
    <p class="post-meta">Apr 23, 2014 • امیر کریمی</p>
  </header>

  <article class="post-content">
    <p>برای یافتن کانکشن‌های برقرار شده با یک سرور می‌توانیم از دستور netstat استفاده کنیم و برای شمردن آن‌ها از دستور wc.</p>

<pre class="brush: bash; title: ; notranslate" title="">netstat -an | wc -l

</pre>

<table>
  <tbody>
    <tr>
      <td>کاراکتر</td>
      <td>(or) خروجی دستور اول را به ورودی دستور دوم می‌فرستد. به عبارت دیگر netstat در هر خط توضیحی در مورد کانکشن می‌دهد و wc تعداد خط‌ها را شمارش می‌کند.</td>
    </tr>
  </tbody>
</table>

<p>و برای اینکه این مقدار را به صورت مرتب و لحظه‌ای (مثلاً هر یک ثانیه یکبار) مشاهده کنیم از دستور watch در لینوکس استفاده می‌کنیم.</p>

<pre class="brush: bash; title: ; notranslate" title="">watch -n1 'netstat -an | wc -l'

</pre>

<p>n1 یعنی هر یک ثانیه یکبار این دستور را اجرا کن و در خروجی نمایش بده. کلاً این watch خیلی ابزار جالبی است. امکاناتی مثل هایلایت کردن تغییرات را هم دارد.</p>

<p>این مقدمه‌ای بود برای اینکه بگویم بین ۲۷۰ تا ۳۱۰ کانکشن فعال (در هر لحظه) بین ساعات ۱۱ شب تا ۱ صبح بر روی سرور نمایشگاه کتاب داریم. البته فعلاً سرورهای نمایشگاه (دو سرور) معماری خاصی دارند که در پست دیگری توضیح می‌دهم اما به طور خلاصه هنوز وب سایت قبلی که بر روی ویندوز بود در حال نمایش است. گلوگاه سیستم سرور لینوکسی است و درخواست‌ها با سرور Nginx به سرور ویندوزی منتقل می‌شوند.</p>

<p>اگر بخواهم دقیقتر بشوم باید فقط کانکشن‌های وب را حساب کنم. با استفاده از دستور grep می‌توانم این فیلتر را اعمال کنم. یعنی به دنبال کانکشن‌هایی بگردم که بر روی پورت ۸۰ برقرار شده‌اند.</p>

<pre class="brush: bash; title: ; notranslate" title="">watch -n1 'netstat -an | grep :80 | wc -l'

</pre>

<p>در همین بازه زمانی تعداد کانکشن‌های وبی روی این سرور بین ۱۰۰ تا ۲۰۰ عدد است. البته از ساعت ۱ صبح به بعد در حال کاهش است.</p>

<p>مقدار اینترنت مصرفی سرور هم امروز در حدود ۱۰۰ مگابایت بر ثانیه معادل ۸۰۰ مگابیت بر ثانیه بود.</p>

  </article>

  

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">چارچوب توسعه</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li><a href="mailto:"></a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          

          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">تجربه‌های یه برنامه‌نویس گیک
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
